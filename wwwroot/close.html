<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Close Window</title>
    <script>
        // Obter os parâmetros da URL
        const urlParams = new URLSearchParams(window.location.search);
        const status = urlParams.get('status');
        const statusUsuario = urlParams.get('status_usuario');
        const accessToken = urlParams.get('access_token');
        const jwtToken = urlParams.get('jwt_token');
        const message = urlParams.get('message');
        const userId = urlParams.get('userId');

        // Enviar mensagem para o opener (janela pai) se existir
        if (window.opener && !window.opener.closed) {
            window.opener.postMessage({
                status: status === 'true',
                status_usuario: statusUsuario,
                access_token: accessToken,
                jwt_token: jwtToken,
                message: decodeURIComponent(message),
                userId: userId
            }, 'http://localhost:5173/'); // Substitua pelo domínio do frontend
        }

        // Fechar a janela após um pequeno atraso para garantir que a mensagem seja enviada
        setTimeout(() => {
            window.close();
        }, 500);
    </script>
</head>
<body>
    <p>Fechando a janela...</p>
</body>
</html>